---
- name: Setup Nginx Web Server on RHEL 9
  hosts: all
  become: true
  tasks:
    - name: Update package manager cache
      ansible.builtin.yum:
        name: "*"
        state: latest

    - name: Install Nginx
      ansible.builtin.yum:
        name: nginx
        state: present

    - name: Start and enable Nginx service
      ansible.builtin.systemd:
        name: nginx
        state: started
        enabled: true

    - name: Verify Nginx is running
      ansible.builtin.uri:
        url: "http://localhost"
        status_code: 200
      register: nginx_status
      retries: 3
      delay: 2
